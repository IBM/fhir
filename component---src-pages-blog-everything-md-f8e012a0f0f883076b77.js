(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{QRca:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return i})),a.d(t,"default",(function(){return p}));a("tkto"),a("yXV3"),a("pNMO"),a("zKZe"),a("q1tI");var n=a("7ljp"),r=a("013z"),c=(a("qKvR"),["components"]);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i={},b={_frontmatter:i},s=r.a;function p(e){var t=e.components,a=o(e,c);return Object(n.b)(s,l({},b,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h1",null,"Introducing the IBM FHIR Server - $everything operation"),Object(n.b)("p",null,"In ",Object(n.b)("a",{parentName:"p",href:"https://github.com/IBM/FHIR/releases/tag/4.7.0"},"IBM FHIR Server 4.7.0"),", the IBM FHIR Server team turned on the ",Object(n.b)("inlineCode",{parentName:"p"},"Patient/$everything")," operation. We have this feature thanks to external contributor and an IBMer, ",Object(n.b)("a",{parentName:"p",href:"https://github.com/luisgarcc"},"Luis García")," who implemented  the operation ",Object(n.b)("a",{parentName:"p",href:"https://github.com/IBM/FHIR/issues/1044"},"#1044"),". "),Object(n.b)("p",null,"So what do you get with ",Object(n.b)("inlineCode",{parentName:"p"},"Patient/$everything"),"? Well, following the HL7 FHIR R4 ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/patient-operation-everything.html"},"specification"),", you get an operation that returns a “searchset” bundle with the information related to a patient in the context it is invoked. In the IBM FHIR Server’s case, the server returns whatever resources are related to the Patient - e.g. practitioners, medications, locations, organizations etc.  You also get support for ",Object(n.b)("inlineCode",{parentName:"p"},"Patient/[id]/$everything")," where the ",Object(n.b)("inlineCode",{parentName:"p"},"[ID]")," is the logical id specific to a patient."),Object(n.b)("p",null,"Let’s build a request and see it in action:"),Object(n.b)("p",null,"We need to know about the parameters of the ",Object(n.b)("inlineCode",{parentName:"p"},"$everything")," operation. "),Object(n.b)("table",null,Object(n.b)("thead",{parentName:"table"},Object(n.b)("tr",{parentName:"thead"},Object(n.b)("th",{parentName:"tr",align:null},"Name"),Object(n.b)("th",{parentName:"tr",align:null},"Type"),Object(n.b)("th",{parentName:"tr",align:null},"Description"))),Object(n.b)("tbody",{parentName:"table"},Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",{parentName:"tr",align:null},Object(n.b)("inlineCode",{parentName:"td"},"start")),Object(n.b)("td",{parentName:"tr",align:null},"date"),Object(n.b)("td",{parentName:"tr",align:null},"The date range relates to care dates, not record currency dates - e.g. all records relating to care provided in a certain date range. If no start date is provided, all records prior to the end date are in scope.")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",{parentName:"tr",align:null},Object(n.b)("inlineCode",{parentName:"td"},"end")),Object(n.b)("td",{parentName:"tr",align:null},"date"),Object(n.b)("td",{parentName:"tr",align:null},"The date range relates to care dates, not record currency dates - e.g. all records relating to care provided in a certain date range. If no end date is provided, all records subsequent to the start date are in scope.")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",{parentName:"tr",align:null},Object(n.b)("inlineCode",{parentName:"td"},"_since")),Object(n.b)("td",{parentName:"tr",align:null},"date"),Object(n.b)("td",{parentName:"tr",align:null},"Resources updated after this period will be included in the response. The intent of this parameter is to allow a client to request only records that have changed since the last request, based on either the return header time, or or (for asynchronous use), the transaction time")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",{parentName:"tr",align:null},Object(n.b)("inlineCode",{parentName:"td"},"_type")),Object(n.b)("td",{parentName:"tr",align:null},"code"),Object(n.b)("td",{parentName:"tr",align:null},"One or more parameters, each containing one or more comma-delimited FHIR resource types to include in the return resources. In the absence of any specified types, the server returns all resource types")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",{parentName:"tr",align:null},Object(n.b)("inlineCode",{parentName:"td"},"return")),Object(n.b)("td",{parentName:"tr",align:null},"Bundle"),Object(n.b)("td",{parentName:"tr",align:null},"The bundle is “searchset”")))),Object(n.b)("p",null,"Note, currently the implementation ignores the ",Object(n.b)("inlineCode",{parentName:"p"},"_count")," parameter."),Object(n.b)("p",null,"Now, let’s prepopulate some sample data on the server using the ",Object(n.b)("a",{parentName:"p",href:"https://github.com/IBM/FHIR/blob/main/fhir-server-test/src/test/resources/testdata/everything-operation/Antonia30_Acosta403.json"},"Integration Test data"),"."),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"Download the Sample Data")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-sh"},"curl -L https://raw.githubusercontent.com/IBM/FHIR/main/fhir-server-test/src/test/resources/testdata/everything-operation/Antonia30_Acosta403.json -o Antonia30_Acosta403.json\n")),Object(n.b)("ol",{start:2},Object(n.b)("li",{parentName:"ol"},"Load the Sample Data bundle to the IBM FHIR Server")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-sh"},"curl -k --location --request POST 'https://localhost:9443/fhir-server/api/v4' \\\n    --header 'Content-Type: application/fhir+json' \\\n    --user \"fhiruser:${DUMMY_PASSWORD}\" \\\n    --data-binary  \"@Antonia30_Acosta403.json\" -o response.json\n")),Object(n.b)("ol",{start:3},Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Scan the response.json for any status that is not ",Object(n.b)("inlineCode",{parentName:"p"},'"status": "201"'),".  For example, the status is in the family of User Request Error or Server Side Error.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Check the ",Object(n.b)("inlineCode",{parentName:"p"},"response.json")," and find the id for Patient (it should be the first one)."))),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-json"},'        {\n            "response": {\n                "id": "178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003",\n                "status": "201",\n                "location": "Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/_history/1",\n                "etag": "W/\\"1\\"",\n                "lastModified": "2021-04-21T13:34:50.207684Z"\n            }\n        },\n')),Object(n.b)("ol",{start:5},Object(n.b)("li",{parentName:"ol"},"Check the ",Object(n.b)("inlineCode",{parentName:"li"},"Patient/[id]/$everything"))),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Request *")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-sh"},"curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/$everything' \\\n    --header 'Content-Type: application/fhir+json' \\\n    --user \"fhiruser:${DUMMY_PASSWORD}\" \\\n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Response *")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-json"},'{\n    "resourceType": "Bundle",\n    "id": "689856f9-6ef6-4d74-8f77-a813ff7b1c6d",\n    "type": "searchset",\n    "total": 895,\n    "entry": [\n        {\n            "fullUrl": "https://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003",\n            "resource": {\n                "resourceType": "Patient",\n                "id": "178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003",\n                "meta": {\n                    "versionId": "1",\n                    "lastUpdated": "2021-04-21T13:34:50.207684Z"\n                }\n                ...\n            }\n        }\n    ]\n}\n')),Object(n.b)("ol",{start:6},Object(n.b)("li",{parentName:"ol"},"Check the ",Object(n.b)("inlineCode",{parentName:"li"},"Patient/[id]/$everything")," with a _type constraint and _since.")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Request *")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-sh"},"curl -k --location --request GET 'https://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/$everything?_type=CarePlan,CareTeam&_since=2021-01-01T00:00:00Z&_count=1' \\\n    --header 'Content-Type: application/fhir+json' \\\n    --user \"fhiruser:${DUMMY_PASSWORD}\" -o care.json\n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Response *")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-json"},'{\n    "resourceType": "Bundle",\n    "id": "689856f9-6ef6-4d74-8f77-a813ff7b1c6d",\n    "type": "searchset",\n    "total": 11,\n    "entry": [\n        {\n            "fullUrl": "https://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003",\n            "resource": {\n                "resourceType": "Patient",\n                "id": "178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003",\n                "meta": {\n                    "versionId": "1",\n                    "lastUpdated": "2021-04-21T13:34:50.207684Z"\n                }\n                ...\n            }\n        }\n    ]\n}\n')),Object(n.b)("p",null,"You’ll see further down CareTeam and CarePlan resources… "),Object(n.b)("ol",{start:7},Object(n.b)("li",{parentName:"ol"},"This is where we can have a bit of fun…  download the ",Object(n.b)("a",{parentName:"li",href:"https://github.com/IBM/FHIR/releases/download/4.7.0/fhir-path-4.7.0-cli.jar"},"fhir-path-cli"))),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-sh"},"curl -L https://github.com/IBM/FHIR/releases/download/4.7.0/fhir-path-4.7.0-cli.jar -o fhir-path-4.7.0-cli.jar\n")),Object(n.b)("ol",{start:8},Object(n.b)("li",{parentName:"ol"},"Let’s run the fhir-path-4.7.0-cli.jar and test a FHIRPath. ")),Object(n.b)("p",null,Object(n.b)("em",{parentName:"p"},"Command Line")),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre"},"java -jar fhir-path-4.7.0-cli.jar --path 'entry.fullUrl' --file care.json \n")),Object(n.b)("p",null,Object(n.b)("em",{parentName:"p"},"Output")," "),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre"},"https://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CarePlan/178f4a3f86a-1a9a1d73-4d1d-46d5-8494-339dddbfe9d2\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CarePlan/178f4a3f86b-06c07a6c-3be7-4e6a-abb2-040ff67c8c1f\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CarePlan/178f4a3f873-d8069835-938e-45b1-9a70-5aba3794f6f3\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CarePlan/178f4a3f87c-ce204596-8037-416c-b2e0-fc7442d9a276\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CarePlan/178f4a3f87c-46785bc7-807a-40e0-bc08-792977ac8ec8\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CareTeam/178f4a3f86a-b79251c3-5019-426e-8211-748adbdfdf54\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CareTeam/178f4a3f86b-22a7baab-77b3-4fb5-b318-9249ea80ec85\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CareTeam/178f4a3f873-e370fba2-f45e-4cdd-b13b-781e249f84f8\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CareTeam/178f4a3f87c-596d80cc-7b42-4054-bc02-a48acfcc95b7\nhttps://localhost:9443/fhir-server/api/v4/Patient/178f4a3f869-6abfe1e6-3a4a-4c9a-81a8-fb8c6263e003/CareTeam/178f4a3f87c-6cc197cd-b665-46e0-ad35-c016edeaf13b\n")),Object(n.b)("p",null,"You’ve seen a brief introduction to fhir-operation-everything and a bonus fhir-path-cli showing the output."),Object(n.b)("p",null,"Note, ",Object(n.b)("inlineCode",{parentName:"p"},"DUMMY_PASSWORD")," should be replaced with or set as a value when the corresponding curl steps are executed."))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-blog-everything-md-f8e012a0f0f883076b77.js.map